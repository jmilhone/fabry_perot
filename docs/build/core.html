

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Core &mdash; Fabry Perot 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tools" href="tools.html" />
    <link rel="prev" title="Welcome to Fabry Perot’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Fabry Perot
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-fabry.core.ringsum">RingSum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fabry.core.models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fabry.core.fitting">Fitting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="finesse.html">Finesse</a></li>
<li class="toctree-l1"><a class="reference internal" href="plasma.html">Plasma</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Fabry Perot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/core.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="core">
<h1>Core<a class="headerlink" href="#core" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-fabry.core.ringsum">
<span id="ringsum"></span><h2>RingSum<a class="headerlink" href="#module-fabry.core.ringsum" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fabry.core.ringsum.get_bin_edges">
<code class="sig-prename descclassname">fabry.core.ringsum.</code><code class="sig-name descname">get_bin_edges</code><span class="sig-paren">(</span><em class="sig-param">dat</em>, <em class="sig-param">x0</em>, <em class="sig-param">y0</em>, <em class="sig-param">binsize=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.ringsum.get_bin_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns equal area annuli bins for a ring image given a center and binsize</p>
<div class="math">
<p><img src="_images/math/c2509810f6bec3d10af91eec3e1036ee06792b06.png" alt="r_n = \sqrt{n \left(2 r_N - \Delta  \right) \Delta } \quad n \in 0,...,N"/></p>
</div><div class="math">
<p><img src="_images/math/ccb5ec5574664fbaf368ff9d0e34e39e0c1d83d3.png" alt="\Delta = \text{ binsize}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dat</strong> (<em>np.ndarray</em>) – pixel values for the camera image</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – x location (pixels) of the center of the image</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – y location (pixels) of the center of the image</p></li>
<li><p><strong>binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – smallest radial bin size (occurs at the largest bin)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bins for the ring sum in pixels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.ringsum.locate_center">
<code class="sig-prename descclassname">fabry.core.ringsum.</code><code class="sig-name descname">locate_center</code><span class="sig-paren">(</span><em class="sig-param">data_in</em>, <em class="sig-param">xguess=None</em>, <em class="sig-param">yguess=None</em>, <em class="sig-param">maxiter=25</em>, <em class="sig-param">binsize=0.1</em>, <em class="sig-param">plotit=False</em>, <em class="sig-param">block_center=False</em>, <em class="sig-param">printit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.ringsum.locate_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the center of a ring pattern image by preforming ringsums.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_in</strong> (<em>np.ndarray</em>) – pixel values for the camera image</p></li>
<li><p><strong>xguess</strong> (<em>float</em>) – guess of x location of center, if None, takes data center</p></li>
<li><p><strong>yguess</strong> (<em>float</em>) – guess of y location of center, if None, takes data center</p></li>
<li><p><strong>maxiter</strong> (<em>int</em>) – maximum number of center finding iterations</p></li>
<li><p><strong>binsize</strong> (<em>float</em>) – smallest radial binsize (occurs at the largest bin)</p></li>
<li><p><strong>plotit</strong> (<em>bool</em>) – plot fitting curves</p></li>
<li><p><strong>block_center</strong> (<em>bool</em>) – block center of image (600x600 on xguess,yguess) when finding center. This helps when
there is a ring at the center of the image.</p></li>
<li><p><strong>printit</strong> (<em>bool</em>) – print center find progress if True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x and y location of the center</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple (float, float)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.ringsum.ringsum">
<code class="sig-prename descclassname">fabry.core.ringsum.</code><code class="sig-name descname">ringsum</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">x0</em>, <em class="sig-param">y0</em>, <em class="sig-param">binsize=0.1</em>, <em class="sig-param">quadrants=False</em>, <em class="sig-param">use_weighted=False</em>, <em class="sig-param">remove_hot_pixels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.ringsum.ringsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a equal annulus area ringsum centered at (x0, y0) from data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 2d image data</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – center location in x</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – center location in y</p></li>
<li><p><strong>binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – the delta r of the last annulus, default=0.1</p></li>
<li><p><strong>quadrants</strong> (<em>bool</em>) – split the ringsum into 4 quadrants to use multiprocessing, default=False</p></li>
<li><p><strong>use_weighted</strong> (<em>bool</em>) – use a weighted mean, default=False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.ringsum.super_pixelate">
<code class="sig-prename descclassname">fabry.core.ringsum.</code><code class="sig-name descname">super_pixelate</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">npix=2</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.ringsum.super_pixelate" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates super pixels for image data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 2d image data</p></li>
<li><p><strong>npix</strong> (<em>int</em>) – integer number of pixels to create an npix x npix super pixel, default=2</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new image made from the super pixels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.ringsum.calculate_weighted_mean">
<code class="sig-prename descclassname">fabry.core.ringsum.</code><code class="sig-name descname">calculate_weighted_mean</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">error</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.ringsum.calculate_weighted_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the weighted mean of data with standard deviation error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – some stuff</p></li>
<li><p><strong>error</strong> (<em>np.ndarray</em>) – standard deviation error bar for data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted mean and weighted standard deviation</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple (float, float)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-fabry.core.models">
<span id="models"></span><h2>Models<a class="headerlink" href="#module-fabry.core.models" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="fabry.core.models.airy_func">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">airy_func</code><a class="headerlink" href="#fabry.core.models.airy_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Airy function (ideal Fabry-Perot instument function)
as a function of wavelength and cos(theta) with parameters d and F</p>
<div class="math">
<p><img src="_images/math/23c12a8d5b7f838e7f5ec87e56ce3d86acb190ed.png" alt="A = \left(1 + Q  \sin^2(\pi \frac{2d}{w} \cos\theta)\right)^{-1}"/></p>
</div><div class="math">
<p><img src="_images/math/e99e048bb0f0228ead306aa4589ac74637f4322c.png" alt="Q = \left(\frac{2  \mathcal{F} }{ \pi } \right)^2"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>np.ndarray</em>) – wavelength array in nm</p></li>
<li><p><strong>cos_th</strong> (<em>np.ndarray</em>) – cos(theta) array</p></li>
<li><p><strong>d</strong> (<em>float</em>) – etalon spacing in mm</p></li>
<li><p><strong>F</strong> (<em>float</em>) – etalon finesse</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>evaluated airy function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.doppler_broadening">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">doppler_broadening</code><a class="headerlink" href="#fabry.core.models.doppler_broadening" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates doppler broadening</p>
<div class="math">
<p><img src="_images/math/d571b7396ebc0f9a01829d8ddeae790a17830b97.png" alt="\sigma = w_0  \sqrt{\frac{k_B T }{ mc^2}}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w0</strong> (<em>float</em>) – central wavelength</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – mass in amu</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – temperature in eV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>doppler broadening sigma</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.doppler_calc">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">doppler_calc</code><a class="headerlink" href="#fabry.core.models.doppler_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the doppler broadening sigma and the new central wavelength
from the doppler shift</p>
<div class="math">
<p><img src="_images/math/d571b7396ebc0f9a01829d8ddeae790a17830b97.png" alt="\sigma = w_0  \sqrt{\frac{k_B T }{ mc^2}}"/></p>
</div><div class="math">
<p><img src="_images/math/af156d989ae0a5cbd0e2d4bf47f81ce0de24d4f6.png" alt="w = w_0 (1 - v/c)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w0</strong> (<em>float</em>) – unshifted wavelength in nm</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – atomic mass in amu</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – temperature in eV</p></li>
<li><p><strong>v</strong> (<em>float</em>) – velocity in m/s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sigma in nm, shifted wavelength in nm</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(float, float))</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.doppler_shift">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">doppler_shift</code><a class="headerlink" href="#fabry.core.models.doppler_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates doppler shift of w0 for velocity v</p>
<div class="math">
<p><img src="_images/math/af156d989ae0a5cbd0e2d4bf47f81ce0de24d4f6.png" alt="w = w_0 (1 - v/c)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w0</strong> (<em>float</em>) – central wavelength</p></li>
<li><p><strong>or float v</strong> (<em>np.ndarray</em>) – velocity in m/s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>doppler shift wavelength from velocity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.forward_model">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">forward_model</code><a class="headerlink" href="#fabry.core.models.forward_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolves the Doppler spectrum with the ideal Fabry-Perot Airy function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>np.ndarray</em>) – array of r values to compute q on</p></li>
<li><p><strong>L</strong> (<em>float</em>) – camera lens focal length, same units as r (pixels or mm)</p></li>
<li><p><strong>d</strong> (<em>float</em>) – etalon spacing (mm)</p></li>
<li><p><strong>F</strong> (<em>float</em>) – etalon finesse</p></li>
<li><p><strong>w0</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>List</em><em>]</em>) – central wavelength(s) in nm</p></li>
<li><p><strong>mu</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>List</em><em>]</em>) – mass(es) in amu</p></li>
<li><p><strong>amp</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>List</em><em>]</em>) – amplitude(s) for the lines</p></li>
<li><p><strong>temp</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>List</em><em>]</em>) – temperature(s) in eV</p></li>
<li><p><strong>v</strong> (<em>Union</em><em>[</em><em>float</em><em>,</em><em>List</em><em>]</em>) – velocities in m/s</p></li>
<li><p><strong>nlambda</strong> (<em>int</em>) – number of points in wavelength array, default=1024</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array length of r of forward q</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.gaussian">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">gaussian</code><a class="headerlink" href="#fabry.core.models.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a gaussian for a given central wavelength, sigma and amp</p>
<div class="math">
<p><img src="_images/math/54729622408aa9ddd03b19a60db7917a970f03ac.png" alt="G = \exp{\left( \frac{ (w - w_0)^2 }{2 \sigma^2 } \right) }"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>np.ndarray</em>) – wavelength array to calculate spec on</p></li>
<li><p><strong>w</strong> (<em>float</em>) – central wavelength (same units as wavelength array)</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – sigma for gaussian (same units as w)</p></li>
<li><p><strong>amp</strong> (<em>float</em>) – amplitude of spectrum, default=1.0</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – if true, the gaussian will be normalized, default=True
to integrate to 1 over infinity then the amp factor will be multiplied</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spectrum evaluated on wavelength array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.general_model">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">general_model</code><a class="headerlink" href="#fabry.core.models.general_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the etalon spectra given plasma spectra vs wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>np.ndarray</em>) – array of pixel r values to compute etalon spectra on</p></li>
<li><p><strong>L</strong> (<em>float</em>) – camera focal length in pixels</p></li>
<li><p><strong>d</strong> (<em>float</em>) – etalon spacing in mm</p></li>
<li><p><strong>F</strong> (<em>float</em>) – etalon finesse</p></li>
<li><p><strong>wavelength</strong> (<em>np.ndarray</em>) – wavelength array</p></li>
<li><p><strong>emission</strong> (<em>np.ndarray</em>) – emission array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>etalon spectra</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.models.lorentzian">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">lorentzian</code><span class="sig-paren">(</span><em class="sig-param">wavelength</em>, <em class="sig-param">w</em>, <em class="sig-param">gamma</em>, <em class="sig-param">amp=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.models.lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a lorentzian for a given central wavelength, gamma and amp</p>
<div class="math">
<p><img src="_images/math/e8ced96d9c1f1d97303ed4003663edc505edae46.png" alt="L = \frac{A}{2 \pi} \frac{\gamma }{ (w-w_0)^2 + (\gamma/2)^2}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> (<em>np.array</em>) – wavelength array to calculate spec on</p></li>
<li><p><strong>w</strong> (<em>float</em>) – central wavelength (same units as wavelength array)</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – lorentzian gamma parameter</p></li>
<li><p><strong>amp</strong> (<em>float</em><em>, </em><em>default=1.</em>) – amplitude in addition to one that integrates
spec to 1 over infinity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spectrum evaluated on wavelength array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>spec (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.models.offset_forward_model">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">offset_forward_model</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">L</em>, <em class="sig-param">d</em>, <em class="sig-param">F</em>, <em class="sig-param">w0</em>, <em class="sig-param">mu</em>, <em class="sig-param">amp</em>, <em class="sig-param">temp</em>, <em class="sig-param">v</em>, <em class="sig-param">nlambda=1024</em>, <em class="sig-param">sm_ang=False</em>, <em class="sig-param">coeff=0.15</em>, <em class="sig-param">Ip=None</em>, <em class="sig-param">Id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.models.offset_forward_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward model with an attempt to model the ‘offset’ from nuissance lines</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>np.ndarray</em>) – array of r values to compute q on</p></li>
<li><p><strong>L</strong> (<em>float</em>) – camera lens focal length, same units as r (pixels or mm)</p></li>
<li><p><strong>d</strong> (<em>float</em>) – etalon spacing (mm)</p></li>
<li><p><strong>F</strong> (<em>float</em>) – etalon finesse</p></li>
<li><p><strong>w0</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>list</em><em>]</em>) – central wavelength(s) in nm</p></li>
<li><p><strong>mu</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>list</em><em>]</em>) – mass(es) in amu</p></li>
<li><p><strong>amp</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>list</em><em>]</em>) – amplitude(s) for the lines</p></li>
<li><p><strong>temp</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>list</em><em>]</em>) – temperature(s) in eV</p></li>
<li><p><strong>v</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>list</em><em>]</em>) – velocities in m/s</p></li>
<li><p><strong>nlambda</strong> (<em>int</em>) – number of points in wavelength array, default=1024</p></li>
<li><p><strong>sm_ang</strong> (<em>bool</em>) – use the small angle approx or not, default=True</p></li>
<li><p><strong>coeff</strong> (<em>float</em>) – coefficient to q the relative amplitude of all the nuissance lines</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array length of r of forward q</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.peak_calculator">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">peak_calculator</code><a class="headerlink" href="#fabry.core.models.peak_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple peak calculator for ideal Fabry-Perot.</p>
<div class="math">
<p><img src="_images/math/288a4da04b7a3888c6bb05e50086d8ec368e12e6.png" alt="r_j = L  \sqrt{ \left( \frac{2d/w}{\rm{Floor}(2d/w)-j}\right)^2 - 1}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>float</em>) – L value, units will set return units (pixels or mm)</p></li>
<li><p><strong>d</strong> (<em>float</em>) – etalon spacing in mm</p></li>
<li><p><strong>w</strong> (<em>float</em>) – peak wavelength in nm</p></li>
<li><p><strong>order</strong> (<em>Union</em><em>[</em><em>np.ndarray</em><em>,</em><em>int</em><em>]</em>) – j order number. 0 gives order nearest center
of rings, increasing j as you move out.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>the location of the peak(s)</dt><dd><p>in the same units as L with the same length as order</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[np.ndarray, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="fabry.core.models.trapezoidal_integration">
<code class="sig-prename descclassname">fabry.core.models.</code><code class="sig-name descname">trapezoidal_integration</code><a class="headerlink" href="#fabry.core.models.trapezoidal_integration" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs trapezoidal intergration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>np.ndarray</em><em>]</em>) – y data points</p></li>
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>np.ndarray</em><em>]</em>) – x data points</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>area under the curve y(x)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-fabry.core.fitting">
<span id="fitting"></span><h2>Fitting<a class="headerlink" href="#module-fabry.core.fitting" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fabry.core.fitting.determine_fit_range">
<code class="sig-prename descclassname">fabry.core.fitting.</code><code class="sig-name descname">determine_fit_range</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">signal</em>, <em class="sig-param">pkr</em>, <em class="sig-param">thres=0.15</em>, <em class="sig-param">plotit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.fitting.determine_fit_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to pick fitting range using peak guess and a threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>np.ndarray</em>) – r data</p></li>
<li><p><strong>signal</strong> (<em>np.ndarray</em>) – ringsum data</p></li>
<li><p><strong>pkr</strong> (<em>float</em>) – guess for peak location</p></li>
<li><p><strong>thres</strong> (<em>float</em>) – threshold from peak that is included, default=0.15</p></li>
<li><p><strong>plotit</strong> (<em>bools</em>) – plots the determined range for checking, default=False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of indexes within threshold of peak guess</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.fitting.find_maximum">
<code class="sig-prename descclassname">fabry.core.fitting.</code><code class="sig-name descname">find_maximum</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">returnval=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.fitting.find_maximum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Finds maximum location of a single peak using simple derivative method. Assumes only one</dt><dd><p>peak is in given data range.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x array of values</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y array of values</p></li>
<li><p><strong>returnval</strong> (<em>bool</em>) – Returns the value at the maximum if True, default=False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>x position of peak</dt><dd><p>if a minimum is detected, returns None</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pk (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fabry.core.fitting.find_maximum_3">
<code class="sig-prename descclassname">fabry.core.fitting.</code><code class="sig-name descname">find_maximum_3</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">y_sd</em>, <em class="sig-param">basename</em>, <em class="sig-param">plotit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.fitting.find_maximum_3" title="Permalink to this definition">¶</a></dt>
<dd><p>guass fit using multinest</p>
</dd></dl>

<dl class="function">
<dt id="fabry.core.fitting.find_peak">
<code class="sig-prename descclassname">fabry.core.fitting.</code><code class="sig-name descname">find_peak</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">x_sd</em>, <em class="sig-param">y_sd</em>, <em class="sig-param">returnval=False</em>, <em class="sig-param">plotit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fabry.core.fitting.find_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses a gaussian fit to find maximum via scipy.odr fit is performed in x^2 space, but all conversions
are taken care of inside this function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values for fit</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values for fit</p></li>
<li><p><strong>x_sd</strong> (<em>np.ndarray</em>) – standard deviation in x values (typically binsize)</p></li>
<li><p><strong>y_sd</strong> (<em>np.ndarray</em>) – standard deviation in y values</p></li>
<li><p><strong>returnval</strong> (<em>bool</em>) – flag for returning fit value at peak location, default=False</p></li>
<li><p><strong>plotit</strong> (<em>bool</em>) – flag for plotting fit, default=False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>peak location, peak location error, peak value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple (float, float, float)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tools.html" class="btn btn-neutral float-right" title="Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Fabry Perot’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Jason Milhone

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>